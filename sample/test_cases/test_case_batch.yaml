tests:

  # batch script
  - name: "Alert weather:: batch no timestamps"
    task_name: alert_weather_batch.tick
    db: weather
    rp: default
    type: batch
    data:
      - temperature,location=us-midwest temperature=110
      - temperature,location=us-midwest temperature=91
    expects:
      ok: 0
      warn: 0
      crit: 1

  # batch script
  - name: "Alert snow:: batch dynamic timestamps"
    task_name: alert_weather_batch.tick
    db: weather
    rp: default
    duration: 3h30m
    type: batch
    data:
      # Note, deliberately including "now" (via "snow")
      # in the data, to make sure 'now()' targeting is clean.
      - snow,location=us-midwest precipitation=5   NOW()-2h
      - snow,location=us-midwest precipitation=10  now()-2h+10m
      - snow,location=us-midwest precipitation=10  now()-2h+20m
      - snow,location=us-midwest precipitation=10  now()-2h+30m
      - snow,location=us-midwest precipitation=10  now()-2h+40m
      - snow,location=us-midwest precipitation=10  now()-2h+50m
      - snow,location=us-midwest precipitation=10  now()-1h
      - snow,location=us-midwest precipitation=10  now()-1h+10m
    expects:
      ok: 0
      warn: 0
      crit: 1
